En matemáticas, la fórmula de Euler Maclaurin relacciona a integrales con series. Esta fórmula puede ser usada para aproximar integrales por sumas finitas o, de forma inversa, para evaluar series (finitas o infnitas) resolviendo integrales. La fórmula fue descubierta independientemente por Leonhard Euler y Colin Maclaurin en 1735. Euler usó esta fórmula para calcular valores de series infinitas con convergencia lenta y Maclaurin la utilizó para calcular integrales.La fórmulaSi n es un número natural y f(x) es una función suave (suficientemente derivable) definida \forall x\in 0,n, entonces, la integralI=\int_0^n f(x)\,dxpuede ser aproximada por la siguiente suma:S=\frac+f\left( 1\right) +\cdots+f\left( n-1\right) + \frac =\frac+\sum_^f\left( k\right) (ver regla del trapecio). La fórmula de Euler Maclaurin nos da una expresión para la diferencia entre la suma y la integral en función de derivadas de f(x) en los extremos del intervalo de integración (0 y n). Para cualquier entero positivo p, tenemos que se cumple:S-I=\sum_^p\frac\left(f^(n)-f^(0)\right)+Rdonde B_ son los números de Bernoulli y R es una estimación del error normalmente pequeña.Realizando un cambio de variable en la integral, se puede modificar esta fórmula para funciones f(x) definidas en otros intervalos de la recta real.El término de errorEl término de error R es: R = (-1)^ \int_0^n f^(x) (x-\lfloor x \rfloor) \over (p+1)!\,dx, donde B_i(x-\lfloor x \rfloor) son los polinomios de Bernoulli periódicos. El término de error se puede acotar por: \left|R\right|\leq\frac\int_0^n\left|f^(x)\right|\,dx.UsosSumas de polinomiosSi f(x) es un polinomio y p'' es suficientemente grande, entonces el término de error ''R se anula, por lo que se pueden resolver series de polinomios de forma exacta. Por ejemplo, si f(x) = x^, escogiendo p = 2 se obtiene:\sum_^n i^3=\left(\frac\right)^2(ver fórmula de Faulhaber).Integración numéricaLa fórmula de Euler-Maclaurin se usa también para el análisis de errores en integraciones numéricas, de hecho, los métodos de extrapolación se basan en esta fórmula.Expansión asintótica de seriesCuando se quiere calcular la expansión asintótica de series, la forma más cómoda de la fórmaula de Euler-Maclaurin es:\sum_^f(n) \sim \int_^ f(x)\,dx+\frac+\sum_^\,\frac\left(f^(b)-f^(a)\right)\, ,donde a y b son enteros. Puede ocurrir que esta fórmula siga siendo válida incluso tomando el límite  o , o ambos. En muchos casos, la integral de la derecha es resoluble mediante funciones elementales de forma cerrada incluso cuando la serie de la izquierda no puede ser resuelta. Entonces, todos los términos de la serie asintótica pueden ser expresados mediante funciones elementales, por ejemplo:\sum_^\frac \sim \underbrace^\frac\,dk_+\frac+\sum_^\frac\, .Donde la serie de la izquierda es igual a la suma de  y (z), donde la serie de la derecha es la función poligamma de primer orden.Restando  a los dos lados de la expresión, obtenemos una serie asintótica de (z). De hecho, esta serie es el punto inicial de una de las posibles derivaciones de la fórmula de Stirling del factorial.DemostraciónDemostración por inducción matemáticaSe seguirá la demostración que aparece en (Apostol).Tom M. Apostol, "An Elementary View of Euler's Summation Formula", American Mathematical Monthly, volume 106, number 5, pages 409—418 (May 1999). .Los polinomios de Bernoulli B_(x) con n = 0,1,2,... se pueden definir recursivamente como sigue:B_0(x) = 1, \,  B_n'(x) = nB_(x)\mbox\int_^ B_(x)dx = 0\mboxn \ge 1. Los primeros 4 son: B_1(x)=x-1/2, \quad B_2(x)=x^2-x+1/6,  B_3(x) = x^3-\fracx^2+\fracx, \quad B_4(x)=x^4-2x^3+x^2-\frac, \dots Los valores B_(1) = B_ son los números de Bernoulli. Para n \ge 2 se cumple B_(0) = B_(1).Las funciones periódicas de Bernoulli P_(x) se definen como: P_n(x) = B_n(x - \lfloor x\rfloor)\mbox0 Es decir, son iguales a los polinomios de Bernoulli en el intervalo (0,1), pero son funciones periódicas de periodo 1 en el resto del eje real.Sea la integral \int_k^ f(x)\,dx = \int u\,dv,donde\beginu &= f(x), \\ du &= f'(x)\,dx, \\ dv &= P_0(x)\,dx \quad (\mboxP_0(x)=1), \\ v &= P_1(x). \endIntegrando por partes obtenemos\beginuv - \int v\,du &= \Big\Big_k^ - \int_k^ f'(x)P_1(x)\,dx \\ \\ &=  - \int_k^ f'(x)P_1(x)\,dx. \end Sumando desde k = 1 hasta k = n se obtiene: \int_1^n f(x)\, dx =  + f(2) + \cdots + f(n-1) +  - \int_1^n f'(x) P_1(x)\,dx. Sumando   a ambos lados de la igualdad y reagrupando términos se obtiene: \sum_^n f(k) = \int_1^n f(x)\,dx +  + \int_1^n f'(x) P_1(x)\,dx.\qquad (1)Por tanto, los dos últimos términos nos dan el error cuando la integral se toma como aproximación de la serie.Consideremos ahora a la siguiente integral: \int_k^ f'(x)P_1(x)\,dx = \int u\,dv, donde\beginu &= f'(x), \\ du &= f''(x)\,dx, \\ dv &= P_1(x)\,dx, \\ v &= P_2(x)/2. \endIntegrando otra vez por partes se obtiene\beginuv - \int v\,du &= \left[  \right]_k^ - \int_k^ f''(x)P_2(x)\,dx \\ \\ &=  -\int_k^ f''(x)P_2(x)\,dx. \endSumando desde k = 1 hasta k = n-1 y reemplazando la última integral en (1) por el resultado que se acaba de obtener, tenemos: \sum_^n f(k) = \int_1^n f(x)\,dx +  +  - \int_1^n f''(x)P_2(x)\,dx. Obviamente, este procedimiento puede ser iterado. de esta manera se obtiene una demostración de la fórmula de Euler-Maclaurin por inducción, en la que los pasos de la inducción constan de una integración por partes y en el uso de las propiedades de las funciones periódicas de Bernoulli.Para acotar el tamaño del error cuando la suma se aproxima por la integral, se tiene en cuenta que, en el intervalo 0,1, los polinomios de Bernoulli alcanzan sus valores máximos absolutos en los puntos finales del intervalo (véase D.H. Lehmer en la referencias) y que B_(1) = B_Demostración mediante análisis funcionalLa fórmula de Euler-Maclaurin puede ser obtenida como una aplicación de algunas ideas de espacios de Hilbert y análisis funcional. Sea B_(x) un polinomio de Bernoulli. Un conjunto de funciones duales a los polinomios de Bernoulli esta dado por\tilde_n(x)=\frac \left[\delta^(1-x) - \delta^(x) \right]donde δ es la función delta de Dirac. Esta fórmula no es más que una notación formal de la idea de tomar derivadas en un punto, entonces se tiene\int_0^1 \tilde_n(x) f(x)\, dx = \frac \left[f^(1) - f^(0) \right]para n  0 y una función diferenciable cualquiera f(x) en el intervalo unidad, para el caso en el que n=0 se define \tilde_(x)=1. Los polinomios de Bernoulli, como sus duales, forman un conjunto ortogonal de estados en el intervalo unidad, así se tiene:\int_0^1 \tilde_m(x) B_n(x)\, dx = \delta_y\sum_^\infty B_n(x) \tilde_n(y) = \delta (x-y).La fórmula de Euler-MacLaurin se obtiene multiplicando la última igualdad por la función a sumar f(y) e integrando el resultado sobre el intervalo unidad:f(x)=\int_0^1 \sum_^\infty B_n(x) \tilde_n(y) f(y)\, dy=\int_0^1 f(y)\,dy +\sum_^ B_n(x) \frac \left[ f^(1) - f^(0) \right]\frac \int_0^1 B_(x-y) f^(y)\, dy.Tomando x=0 y reagrupando términos se obtiene la fórmula buscada junto con el término de error. Nótese que los números de Bernoulli se definen como B_=B_(0) y que estos se anulan para n impares mayores que 1. Nótese también que en esta derivación se asume que la función f(x) es suficientemente diferenciable, en particular, f(x) ha de ser una función analíticaLa fórmula de Euler-MacLaurin puede verse como una representación de funciones en el intervalo unidad por el producto directo de los polinomios de Bernoulli y sus duales. Sin embargo, esta representación no es completa en el conjunto de funciones cuadrado integrables. La expansión en término de polinomios de Bernoulli tiene una núcleo no trivial. En particular, \sin(2\pi x) pertenece al núcleo, pues la integral de \sin(2\pi x) se anula en el intervalo unidad, así como la diferencia de sus derivadas en los extremos del intervalo.ReferenciasPierre Gaspard, "r-adic one-dimensional maps and the Euler summation formula", Journal of Physics A, 25 (letter) L483-L485 (1992). (Describe las autofunciones del operador de transferencia para el mapa de Bernoulli)Xavier Gourdon and Pascal Sebah, Introduction on Bernoulli's numbers, (2002)D.H. Lehmer, "On the Maxima and Minima of Bernoulli Polynomials", American Mathematical Monthly, volume 47, pages 533–538 (1940)Categoría:Integración numérica Categoría:Series matemáticas Categoría:Análisis asintóticode:Euler-Maclaurin-Formel en:Euler–Maclaurin formula fr:Formule d'Euler-Maclaurin hu:Euler-Maclaurin képlet it:Formula di Eulero-Maclaurin ja:オイラーの和公式 km:រូបមន្តអយល័រ-ម៉ាក្លូរីន nl:Formule van Euler-Maclaurin pl:Wzór Eulera-Maclaurina